<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>Luciela_dh wololo Counter</title>
  <link rel="icon" type="image/png" href="luci31.png">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <!-- Game features tooltip -->
  <style>
    .feature-tooltip {
      position: fixed;
      right: 20px;
      top: 20px;
      background: rgba(0, 0, 0, 0.9);
      padding: 15px;
      border-radius: 10px;
      color: white;
      z-index: 1000;
      max-width: 300px;
      box-shadow: 0 0 20px rgba(255, 77, 77, 0.3);
      animation: slideIn 0.5s ease-out;
    }
    .feature-tooltip h3 {
      color: #ff4d4d;
      margin-bottom: 10px;
    }
    .feature-tooltip ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .feature-tooltip li {
      margin: 8px 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .feature-tooltip img {
      width: 30px;
      height: 30px;
      object-fit: contain;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    .stats-panel {
      position: fixed;
      left: 20px;
      top: 20px;
      background: rgba(0, 0, 0, 0.8);
      padding: 15px;
      border-radius: 10px;
      color: white;
      z-index: 1000;
    }
    .game-title {
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      animation: glow 2s infinite alternate;
      color: white;
      background: linear-gradient(45deg, #ff4d4d, #ff9999);
      padding: 15px 30px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(255, 77, 77, 0.5);
      margin-bottom: 30px;
      font-size: 3.5rem;
      letter-spacing: 2px;
      position: relative;
      z-index: 10;
    }
    @keyframes glow {
      from { 
        text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff4d4d;
        box-shadow: 0 0 20px rgba(255, 77, 77, 0.5);
      }
      to { 
        text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff4d4d;
        box-shadow: 0 0 30px rgba(255, 77, 77, 0.8);
      }
    }
    
    @keyframes pulse {
      0% { transform: translate(-50%, 50%) scale(1); }
      50% { transform: translate(-50%, 50%) scale(1.1); }
      100% { transform: translate(-50%, 50%) scale(1); }
    }

    .challenge-notification {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      z-index: 9999;
      animation: bounceIn 0.5s;
    }

    /* Shop Styles */
    .shop-content {
      min-width: 600px;
      max-width: 800px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .shop-items {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      padding: 20px 0;
    }

    .shop-item {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: 2px solid #ff9900;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      color: white;
    }

    .shop-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(255, 153, 0, 0.5);
    }

    .shop-item-icon {
      font-size: 40px;
      margin-bottom: 10px;
    }

    .shop-item-name {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 5px;
    }

    .shop-item-description {
      font-size: 12px;
      color: #ddd;
      margin-bottom: 10px;
      min-height: 30px;
    }

    .shop-item-price {
      background: rgba(0, 0, 0, 0.5);
      padding: 8px;
      border-radius: 5px;
      font-size: 14px;
      font-weight: bold;
      color: #ffdd00;
      margin-bottom: 10px;
    }

    .shop-item-button {
      background: #2ecc71;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      width: 100%;
      transition: background 0.3s;
    }

    .shop-item-button:hover {
      background: #27ae60;
    }

    .shop-item-button:disabled {
      background: #999;
      cursor: not-allowed;
      opacity: 0.5;
    }
  </style>
</head>
<!-- Fixed bottom nav -->
<nav class="bottom-nav">
  <button id="navMissileButton">
    <img src="bunbat missil.png" alt="Missile Icon" style="height: 100px; vertical-align:middle;">
  </button>
  <button id="navShopButton">
    <img src="bunbat shop.png" alt="Shop Icon" style="height: 100px; vertical-align:middle;">
  </button>
  <button id="navHelpButton">
    <img src="bunbat help.png" alt="Help Icon" style="height: 100px; vertical-align:middle;">
  </button>
  <button id="navClickerButton">
    <img src="bunbat clicker.png" alt="Challenge Icon" style="height: 100px; vertical-align:middle;" title="Country Challenge">
  </button>
</nav>

<!-- Challenge Modal -->
<div id="challengeModal" class="modal">
  <div class="modal-content challenge-content">
    <span class="close-btn" id="closeChallenge">&times;</span>
    <div class="challenge-tabs">
      <button class="tab-button active" data-tab="create">Create Challenge</button>
      <button class="tab-button" data-tab="active">Active Challenges</button>
    </div>

    <div class="tab-content" id="createChallenge">
      <h2>Challenge Another Country</h2>
      <div class="challenge-form">
        <div class="input-group">
          <label for="challengeCountry">Target Country:</label>
          <input type="text" id="challengeCountry" maxlength="3" placeholder="e.g. USA, AR, JP">
        </div>
        <div class="input-group">
          <label for="betAmount">Bet Amount:</label>
          <input type="number" id="betAmount" min="1" placeholder="Enter clicks to bet">
        </div>
        <button id="createChallengeBtn" class="challenge-button">Create Challenge</button>
      </div>
    </div>

    <div class="tab-content" id="activeChallenges" style="display: none;">
      <h2>Your Challenges</h2>
      <div id="challengesList" class="challenges-list">
        <!-- Challenges will be populated here -->
      </div>
    </div>
  </div>
</div>

<!-- Shop Modal -->
<div id="shopModal" class="modal">
  <div class="modal-content shop-content">
    <span class="close-btn" id="closeShop">&times;</span>
    <h2 style="text-align: center; color: #ff9900; margin-bottom: 20px;">üõçÔ∏è Shop - Buy Power-ups</h2>
    <div id="shopItems" class="shop-items"></div>
    <div id="shopStatus" style="text-align: center; margin-top: 15px; font-size: 14px; color: #ffdd00;"></div>
  </div>
</div>

<!-- Modal for missile input -->
<div id="missileModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" id="closeModal">&times;</span>
    <h2>Enter Target Country</h2>
    <input type="text" id="manualCountry" maxlength="3" placeholder="e.g. USA, AR, JP">
    <button id="manualLaunch">Confirm</button>
  </div>
</div>
<div id="HelpModal" class="modal">
  <div class="modal-content help-content">
    <span class="close-btn" id="closeHelp">&times;</span>
    <h2 class="help-title">Game Guide</h2>
    
    <div class="help-section">
      <h3>üéØ Basic Gameplay</h3>
      <ul>
        <li>Click the Luci gif to contribute to the global counter</li>
        <li>Watch for the golden bunbat to appear for bonus points!</li>
        <li>Your country's total is shown in the rankings</li>
        <li>Earn tier badges based on your click count: Bronze ‚Üí Silver ‚Üí Gold ‚Üí Legendary</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>üèÜ Tier System</h3>
      <ul>
        <li><strong>ü•â Bronze:</strong> Less than 1,000 clicks</li>
        <li><strong>ü•à Silver:</strong> 1,000 - 9,999 clicks</li>
        <li><strong>ü•á Gold:</strong> 10,000 - 99,999 clicks</li>
        <li><strong>üëë Legendary:</strong> 100,000+ clicks</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>‚öîÔ∏è Country Challenges</h3>
      <ol>
        <li>Click the <img src="bunbat clicker.png" alt="Challenge" style="height: 30px; vertical-align:middle;"> button</li>
        <li>Choose a country to challenge and bet your clicks</li>
        <li>When the challenge is accepted, both countries have 30 seconds to click as fast as possible!</li>
        <li>The winning country gets both bet amounts</li>
      </ol>
    </div>

    <div class="help-section">
      <h3>üöÄ Missile Attacks</h3>
      <ol>
        <li>
          <strong>Launch:</strong> 
          <img src="bunbat missil.png" alt="Missile Icon" style="height: 30px; vertical-align:middle;">
          Click to start
        </li>
        <li>
          <strong>Cost:</strong> 
          Missiles cost <strong>50 clicks</strong> to launch
        </li>
        <li>
          <strong>Target:</strong> 
          Enter country code (e.g., <strong>US</strong>, <strong>AR</strong>)
          <img src="inputcountry.png" alt="Input Country" style="height: 50px; vertical-align:middle;">
        </li>
        <li>
          <strong>Attack:</strong> 
          <img src="Redbutton.png" alt="Frenzy Button" style="height: 50px; vertical-align:middle;">
          Click fast for 30 seconds - each click = 1 damage (capped at 50% of target's clicks)!
        </li>
        <li>
          <strong>Shield:</strong> 
          After being hit by a missile, countries get a 2-hour shield from further attacks
        </li>
      </ol>
      <p class="help-note">‚è∞ Cooldown: 30 minutes between missile launches per country</p>
    </div>

    <div class="help-section">
      <h3>üõçÔ∏è Shop - Power-ups</h3>
      <p>Click the Shop button to buy consumable power-ups:</p>
      <ul>
        <li><strong>‚ö° Click Boosts:</strong> Buy +100 or +500 instant clicks</li>
        <li><strong>üõ°Ô∏è Shield:</strong> Protect yourself from missiles for 1-2 hours</li>
        <li><strong>üöÄ Missile Reset:</strong> Instantly reset your missile cooldown</li>
        <li><strong>2Ô∏è‚É£ Click Multiplier:</strong> Double your clicks for 60 seconds</li>
      </ul>
      <p class="help-note">üí∞ All items are purchased with your clicks</p>
    </div>

    <div class="help-section">
      <h3>üí° Pro Tips</h3>
      <ul>
        <li>Time your missile attacks when target countries have high click counts</li>
        <li>Challenge countries with similar click counts for fair duels</li>
        <li>Keep an eye on the rankings to spot potential targets</li>
        <li>Golden bunbats appear randomly - don't miss them!</li>
        <li>Use shop power-ups strategically to gain advantages in battles</li>
        <li>Shields are useful before expected missile attacks!</li>
      </ul>
    </div>
  </div>
</div>
<div id="cooldownModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" id="closeCooldown">&times;</span>
    <h2>Missile Cooldown</h2>
    <p id="cooldownMessage">This country is still on cooldown.</p>
  </div>
</div>
<body>
  <!-- Game Features Tooltip -->
  <div class="feature-tooltip">
    <h3>üéÆ Game Features</h3>
    <ul>
      <li>
        <img src="bunbat clicker.png" alt="Challenge">
        Challenge other countries to clicking duels!
      </li>
      <li>
        <img src="bunbat missil.png" alt="Missile">
        Launch missiles to steal clicks
      </li>
      <li>
        <img src="bunbat golden.png" alt="Golden">
        Click golden bunbats for bonus points
      </li>
      <li>
        <img src="bunbat help.png" alt="Help">
        Need help? Click for instructions
      </li>
    </ul>
  </div>

  <div class="left">
    <div class="title-container">
      <h1 class="game-title animate__animated animate__bounceIn">Global wololo Counter</h1>
      <div class="title-decoration"></div>
    </div>

    <button class="gif-button" id="mainClickButton" title="Click me to add to the global counter!">
      <img
        alt="Click Me"
        src="https://media1.tenor.com/m/NVtYAkt7vQ0AAAAC/lucieladh-yipee-luci.gif"
        class="gif-image"
      />
    </button>
    <img id="apple" src="bunbat golden.png" alt="Golden Bunbat" title="Click the golden bunbat for bonus points!">

    <!-- Stats Panel -->
    <div class="stats-panel">
      <div id="topFlag" style="margin-bottom: 10px;"></div>
      <div id="response" style="font-size: 2rem; margin-bottom: 5px;"></div>
      <div id="response2" style="font-size: 1rem; color: #ffdd00;"></div>
    </div>
    <!--Click button (make it droppable) 
<div id="clickButtonDrop" ondrop="dropAutoclicker(event)" ondragover="allowDrop(event)">
  <button class="gif-button" id="mainClickButton" onclick="clickButton()">
    <img
      class="gif-frame"
      src="bunbat clicker.png"
      alt="Tenor GIF"
    />
  </button>
</div>

  </button>
</div>-->

    <footer>
      Subscribe to <a href="https://www.twitch.tv/luciela_dh" target="_blank">Luciela_dh</a><br />
      Created by <a href="" target="_blank">bye_nary01010</a>
      model site checkit <a href="model.html" target="_blank">here</a>
      cover <a href="wheeltest.html" target="_blank">here</a>
    </footer>

    <audio id="clickSound" src="wolol.mp3" preload="auto"></audio>



    <div id="missileStatus" style="margin-top:10px; font-size:1.2rem; color:#ffdd00;"></div>

    <!-- Missile targeting -->
    <div id="missileTargetContainer" style="margin-top:10px; display:none;">
      <select id="missileTarget"></select>
      <button id="confirmMissile" style="display:none;">Launch!</button>
      <span id="missileTimer" style="margin-left:10px; color:#ffdd00;"></span>
    </div>
  </div>
<!-- Put this near your other missile elements -->
<button id="frenzyMissileButton" style="display:none; background:red; color:white; font-size:1.5rem; padding:10px; margin-top:10px;">
  CLICK FAST! 10s left
</button>
<div id="frenzyMissileResult" style="margin-top:10px; color:#ffdd00; font-size:1.2rem;"></div>


  <div class="right">
    <div id="boostTimer">Boost: OFF</div>
<!-- Autoclicker menu item 
<div id="autoclickerMenu" style="margin-top:20px;">
  <div id="autoclickerItem" draggable="true" 
       style="width:100px; padding:10px; background:#4CAF50; color:white; text-align:center; cursor:grab; border-radius:10px;">
    Autoclicker
  </div>
</div>-->
    <div id="ranking">
      <h2>Ranking by country</h2>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Tier</th>
            <th>Country</th>
            <th>Clicks</th>
          </tr>
        </thead>
        <tbody id="rankingBody"></tbody>
      </table>
    </div>
  </div>

  <script src="challenge.js"></script>
  <script type="module" src="main.js" defer></script>
  <script>
// --- Auto-refresh ranking table every 5 seconds ---
function loadRanking() {
  fetch('/api/leaderboard')
    .then(res => res.json())
    .then(data => {
      const tbody = document.getElementById('rankingBody');
      tbody.innerHTML = '';
      data.top10.forEach((row, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i + 1}</td>
          <td>${row.tier?.icon || ''} ${row.tier?.name || ''}</td>
          <td>${row.country_code}</td>
          <td>${row.clicks.toLocaleString()}</td>
        `;
        tbody.appendChild(tr);
      });
    });
}

// Initial load
loadRanking();
// Poll every 5 seconds
setInterval(loadRanking, 1000);

// ==================== SHOP SYSTEM ====================
const SHOP_ITEMS = [
  {
    id: 'click_boost_100',
    name: '+100 Clicks',
    icon: '‚ö°',
    description: 'Get 100 instant clicks',
    price: 50,
    effect: 'add_clicks',
    value: 100
  },
  {
    id: 'click_boost_500',
    name: '+500 Clicks',
    icon: '‚ö°‚ö°',
    description: 'Get 500 instant clicks',
    price: 200,
    effect: 'add_clicks',
    value: 500
  },
  {
    id: 'shield_1hr',
    name: '1-Hour Shield',
    icon: 'üõ°Ô∏è',
    description: 'Protection from missiles for 1 hour',
    price: 150,
    effect: 'shield',
    value: 60
  },
  {
    id: 'shield_2hr',
    name: '2-Hour Shield',
    icon: 'üõ°Ô∏èüõ°Ô∏è',
    description: 'Protection from missiles for 2 hours',
    price: 250,
    effect: 'shield',
    value: 120
  },
  {
    id: 'missile_reset',
    name: 'Missile Reset',
    icon: 'üöÄ',
    description: 'Instantly reset missile cooldown',
    price: 100,
    effect: 'reset_missile',
    value: 1
  },
  {
    id: '2x_multiplier',
    name: '2x Click Multiplier',
    icon: '2Ô∏è‚É£',
    description: 'Double your clicks for 60 seconds',
    price: 300,
    effect: 'multiplier',
    value: 2
  }
];

function loadShop() {
  const shopItemsDiv = document.getElementById('shopItems');
  shopItemsDiv.innerHTML = '';
  
  fetch('/api/stats/my-country')
    .then(res => res.json())
    .then(country => {
      SHOP_ITEMS.forEach(item => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'shop-item';
        const hasEnough = country.clicks >= item.price;
        
        itemDiv.innerHTML = `
          <div class="shop-item-icon">${item.icon}</div>
          <div class="shop-item-name">${item.name}</div>
          <div class="shop-item-description">${item.description}</div>
          <div class="shop-item-price">üí∞ ${item.price} clicks</div>
          <button class="shop-item-button" 
                  onclick="buyItem('${item.id}', ${item.price})"
                  ${hasEnough ? '' : 'disabled'}>
            ${hasEnough ? 'BUY' : 'NEED ' + (item.price - country.clicks) + ' MORE'}
          </button>
        `;
        shopItemsDiv.appendChild(itemDiv);
      });
    });
}

async function buyItem(itemId, price) {
  const item = SHOP_ITEMS.find(i => i.id === itemId);
  if (!item) return;
  
  try {
    const res = await fetch('/api/shop/buy', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ itemId })
    });

    const data = await res.json();
    
    if (!res.ok) {
      alert(`‚ùå ${data.error}`);
      loadShop();
      return;
    }

    // Show success message
    alert(`‚úÖ ${data.message}`);

    // Reload shop and ranking
    document.getElementById('shopStatus').innerHTML = `<span style="color: #2ecc71;">‚úÖ Purchase successful!</span>`;
    setTimeout(() => {
      loadShop();
      loadRanking();
      document.getElementById('shopStatus').innerHTML = '';
    }, 2000);

  } catch (error) {
    console.error('Error buying item:', error);
    alert('‚ùå Purchase failed!');
    loadShop();
  }
}
</script>
</body>
</html>
